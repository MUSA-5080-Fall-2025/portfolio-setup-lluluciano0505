library(ggplot2)
library(scales)
ggplot(county_map) +
geom_sf(aes(fill = .data[[fill_var]]), color = "white", size = 0.2) +
scale_fill_viridis(
option = "C",
direction = 1,
na.value = "grey85",
name = fill_label
) +
annotation_scale(location = "bl", text_cex = 0.7, line_width = 0.6) +
annotation_north_arrow(
location = "bl",
which_north = "true",
style = north_arrow_fancy_orienteering,
height = unit(0.9, "cm"),
width  = unit(0.9, "cm")
) +
coord_sf(crs = st_crs(5070)) +
labs(
title = "Healthcare Access Challenges in Pennsylvania (County Level)",
subtitle = "Emphasis on vulnerable tracts and access to hospitals",
caption = "Projection: EPSG 5070 (USA_Contiguous_Albers_Equal_Area_Conic)"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major = element_line(color = "grey90", linewidth = 0.2),
legend.position = "right",
plot.title = element_text(face = "bold")
)
library(viridis)
ggplot(county_map) +
geom_sf(aes(fill = .data[[fill_var]]), color = "white", size = 0.2) +
scale_fill_viridis(
option = "C",
direction = 1,
na.value = "grey85",
name = fill_label
) +
annotation_scale(location = "bl", text_cex = 0.7, line_width = 0.6) +
annotation_north_arrow(
location = "bl",
which_north = "true",
style = north_arrow_fancy_orienteering,
height = unit(0.9, "cm"),
width  = unit(0.9, "cm")
) +
coord_sf(crs = st_crs(5070)) +
labs(
title = "Healthcare Access Challenges in Pennsylvania (County Level)",
subtitle = "Emphasis on vulnerable tracts and access to hospitals",
caption = "Projection: EPSG 5070 (USA_Contiguous_Albers_Equal_Area_Conic)"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major = element_line(color = "grey90", linewidth = 0.2),
legend.position = "right",
plot.title = element_text(face = "bold")
)
library(ggspatial)
ggplot(county_map) +
geom_sf(aes(fill = .data[[fill_var]]), color = "white", size = 0.2) +
scale_fill_viridis(
option = "C",
direction = 1,
na.value = "grey85",
name = fill_label
) +
annotation_scale(location = "bl", text_cex = 0.7, line_width = 0.6) +
annotation_north_arrow(
location = "bl",
which_north = "true",
style = north_arrow_fancy_orienteering,
height = unit(0.9, "cm"),
width  = unit(0.9, "cm")
) +
coord_sf(crs = st_crs(5070)) +
labs(
title = "Healthcare Access Challenges in Pennsylvania (County Level)",
subtitle = "Emphasis on vulnerable tracts and access to hospitals",
caption = "Projection: EPSG 5070 (USA_Contiguous_Albers_Equal_Area_Conic)"
) +
theme_minimal(base_size = 12) +
theme(
panel.grid.major = element_line(color = "grey90", linewidth = 0.2),
legend.position = "right",
plot.title = element_text(face = "bold")
)
# Packages
library(ggplot2)
library(viridis)
library(ggspatial)
# Merge county polygons with computed statistics
county_map <- pa_counties_proj %>%
left_join(county_stats, by = "COUNTY_NAM")
# Create map
ggplot() +
# County fill by % underserved vulnerable tracts
geom_sf(
data = county_map,
aes(fill = pct_underserved),
color = "white",
size = 0.2
) +
# Add hospital locations
geom_sf(
data = hospitals_proj,
color = "red",
size = 1,
alpha = 0.7
) +
# Color scheme
scale_fill_viridis(
option = "C",
name = "% of Vulnerable Tracts Underserved",
labels = scales::label_percent(accuracy = 1, scale = 1),
na.value = "grey90"
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Counties filled by % of vulnerable tracts that are underserved\nRed points show hospital locations",
caption = "Source: ACS 2022 5-Year Estimates; PA Hospital Dataset | Projection: EPSG 5070 (Albers Equal Area)"
) +
theme_void(base_size = 12) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 9, color = "gray40")
)
# Create map
ggplot() +
# County fill by % underserved vulnerable tracts
geom_sf(
data = county_map,
aes(fill = pct_underserved),
color = "white",
size = 0.2
) +
# Add hospital locations
geom_sf(
data = hospitals_proj,
color = "black",
size = 1,
alpha = 0.7
) +
# Color scheme
scale_fill_viridis(
option = "C",
name = "% of Vulnerable Tracts Underserved",
labels = scales::label_percent(accuracy = 1, scale = 1),
na.value = "grey90"
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Counties filled by % of vulnerable tracts that are underserved\nRed points show hospital locations",
caption = "Source: ACS 2022 5-Year Estimates; PA Hospital Dataset | Projection: EPSG 5070 (Albers Equal Area)"
) +
theme_void(base_size = 12) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 9, color = "gray40")
)
ggplot() +
# 1. 先画普查小区层（用 vulnerable/underserved 标识）
geom_sf(
data = census_tracts_demo,
aes(fill = factor(if_else(underserved == 1, "Underserved", "Other"))),
color = NA, alpha = 0.9
) +
# 2. 再叠加县界
geom_sf(data = pa_counties_proj, fill = NA, color = "white", size = 0.3) +
# 3. 医院点
geom_sf(data = hospitals_proj, color = "black", size = 1, alpha = 0.7) +
# 4. 色彩与主题
scale_fill_manual(
values = c("Underserved" = "red", "Other" = "grey80"),
name = "Tract Type"
) +
labs(
title = "Underserved Vulnerable Census Tracts in Pennsylvania",
subtitle = "Red tracts are both vulnerable and more than 15 miles from the nearest hospital",
caption = "Sources: ACS 2022 5-year (tidycensus), lecture hospital data"
) +
theme_void() +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 8, color = "grey30")
)
# Create detailed tract-level map
library(dplyr)
library(ggplot2)
library(sf)
library(scales)
pa_counties_map <- pa_counties_proj %>%
left_join(
county_stats %>%
mutate(pct_underserved = as.numeric(pct_underserved)),
by = c("COUNTY_NAM")
)
ggplot() +
# 1. 先画普查小区层（用 vulnerable/underserved 标识）
geom_sf(
data = census_tracts_demo,
aes(fill = factor(if_else(underserved == 1, "Underserved", "Other"))),
color = NA, alpha = 0.9
) +
# 2. 再叠加县界
geom_sf(data = pa_counties_proj, fill = NA, color = "white", size = 0.3) +
# 3. 医院点
geom_sf(data = hospitals_proj, color = "black", size = 1, alpha = 0.7) +
# 4. 色彩与主题
scale_fill_manual(
values = c("Underserved" = "red", "Other" = "grey80"),
name = "Tract Type"
) +
labs(
title = "Underserved Vulnerable Census Tracts in Pennsylvania",
subtitle = "Red tracts are both vulnerable and more than 15 miles from the nearest hospital",
caption = "Sources: ACS 2022 5-year (tidycensus), lecture hospital data"
) +
theme_void() +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 8, color = "grey30")
)
# Create map
ggplot() +
# County fill by % underserved vulnerable tracts
geom_sf(
data = county_map,
aes(fill = pct_underserved),
color = "white",
size = 0.2
) +
# Add hospital locations
geom_sf(
data = hospitals_proj,
color = "",
size = 1,
alpha = 0.7
) +
# Color scheme
scale_fill_viridis(
option = "C",
name = "% of Vulnerable Tracts Underserved",
labels = scales::label_percent(accuracy = 1, scale = 1),
na.value = "grey90"
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Counties filled by % of vulnerable tracts that are underserved\nRed points show hospital locations",
caption = "Source: ACS 2022 5-Year Estimates; PA Hospital Dataset | Projection: EPSG 5070 (Albers Equal Area)"
) +
theme_void(base_size = 12) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 9, color = "gray40")
)
# Packages
library(ggplot2)
library(viridis)
library(ggspatial)
# Merge county polygons with computed statistics
county_map <- pa_counties_proj %>%
left_join(county_stats, by = "COUNTY_NAM")
# Create map
ggplot() +
# County fill by % underserved vulnerable tracts
geom_sf(
data = county_map,
aes(fill = pct_underserved),
color = "white",
size = 0.2
) +
# Add hospital locations
geom_sf(
data = hospitals_proj,
color = "",
size = 1,
alpha = 0.7
) +
# Color scheme
scale_fill_viridis(
option = "C",
name = "% of Vulnerable Tracts Underserved",
labels = scales::label_percent(accuracy = 1, scale = 1),
na.value = "grey90"
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Counties filled by % of vulnerable tracts that are underserved\nRed points show hospital locations",
caption = "Source: ACS 2022 5-Year Estimates; PA Hospital Dataset | Projection: EPSG 5070 (Albers Equal Area)"
) +
theme_void(base_size = 12) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 9, color = "gray40")
)
# Packages
library(ggplot2)
library(viridis)
library(ggspatial)
# Merge county polygons with computed statistics
county_map <- pa_counties_proj %>%
left_join(county_stats, by = "COUNTY_NAM")
# Create map
ggplot() +
# County fill by % underserved vulnerable tracts
geom_sf(
data = county_map,
aes(fill = pct_underserved),
color = "white",
size = 0.2
) +
# Add hospital locations
geom_sf(
data = hospitals_proj,
color = "red",
size = 1,
alpha = 0.7
) +
# Color scheme
scale_fill_viridis(
option = "C",
name = "% of Vulnerable Tracts Underserved",
labels = scales::label_percent(accuracy = 1, scale = 1),
na.value = "grey90"
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Counties filled by % of vulnerable tracts that are underserved\nRed points show hospital locations",
caption = "Source: ACS 2022 5-Year Estimates; PA Hospital Dataset | Projection: EPSG 5070 (Albers Equal Area)"
) +
theme_void(base_size = 12) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 11),
plot.caption = element_text(size = 9, color = "gray40")
)
# Create detailed tract-level map
library(dplyr)
library(ggplot2)
library(sf)
library(scales)
pa_counties_map <- pa_counties_proj %>%
left_join(
county_stats %>%
mutate(pct_underserved = as.numeric(pct_underserved)),
by = c("COUNTY_NAM")
)
ggplot() +
geom_sf(
data = pa_counties_map,
aes(fill = pct_underserved),
color = "white", size = 0.25
) +
geom_sf(
data = hospitals_proj,
shape = 21, fill = "black", color = "white", size = 1.4, alpha = 0.7
) +
scale_fill_viridis_c(
name = "% Underserved (of vulnerable tracts)",
labels = function(x) paste0(x, "%"),
na.value = "grey90",
option = "-magma",
limits = c(0, 100)
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Percent of vulnerable census tracts that are >15 miles from the nearest hospital",
caption = "Sources: ACS 2022 5-year (tidycensus), lecture hospital data, county boundaries"
) +
theme_void() +
theme(
legend.position = "right",
legend.title = element_text(size = 10, face = "bold"),
legend.text  = element_text(size = 9),
plot.title   = element_text(size = 14, face = "bold"),
plot.subtitle= element_text(size = 11),
plot.caption = element_text(size = 8, color = "grey30"),
panel.background = element_rect(fill = "grey98", color = NA)
)
ggplot() +
geom_sf(
data = pa_counties_map,
aes(fill = pct_underserved),
color = "white", size = 0.25
) +
geom_sf(
data = hospitals_proj,
shape = 21, fill = "black", color = "white", size = 1.4, alpha = 0.7
) +
scale_fill_viridis_c(
name = "% Underserved (of vulnerable tracts)",
labels = function(x) paste0(x, "%"),
na.value = "grey90",
option = "-magma",
limits = c(0, 100)
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Percent of vulnerable census tracts that are >15 miles from the nearest hospital",
caption = "Sources: ACS 2022 5-year (tidycensus), lecture hospital data, county boundaries"
) +
theme_void() +
theme(
legend.position = "right",
legend.title = element_text(size = 10, face = "bold"),
legend.text  = element_text(size = 9),
plot.title   = element_text(size = 14, face = "bold"),
plot.subtitle= element_text(size = 11),
plot.caption = element_text(size = 8, color = "grey30"),
panel.background = element_rect(fill = "grey98", color = NA)
)
ggplot() +
geom_sf(
data = pa_counties_map,
aes(fill = pct_underserved),
color = "white", size = 0.25
) +
geom_sf(
data = hospitals_proj,
shape = 21, fill = "black", color = "white", size = 1.4, alpha = 0.7
) +
scale_fill_viridis_c(
name = "% Underserved (of vulnerable tracts)",
labels = function(x) paste0(x, "%"),
na.value = "grey90",
option = "-magma",
limits = c(0, 100)
) +
labs(
title = "Healthcare Access Challenges in Pennsylvania",
subtitle = "Percent of vulnerable counties that are >15 miles from the nearest hospital",
caption = "Sources: ACS 2022 5-year (tidycensus), lecture hospital data, county boundaries"
) +
theme_void() +
theme(
legend.position = "right",
legend.title = element_text(size = 10, face = "bold"),
legend.text  = element_text(size = 9),
plot.title   = element_text(size = 14, face = "bold"),
plot.subtitle= element_text(size = 11),
plot.caption = element_text(size = 8, color = "grey30"),
panel.background = element_rect(fill = "grey98", color = NA)
)
tracts_final <- census_tracts_demo %>%
left_join(
tract_centroids %>%
st_drop_geometry() %>%
select(GEOID, nearest_hosp_dist_mi, vulnerable, underserved),
by = "GEOID"
)
ggplot() +
geom_sf(
data = tracts_final,
aes(fill = factor(underserved, levels = c(0, 1), labels = c("Not Underserved", "Underserved"))),
color = "white", size = 0.1
) +
geom_sf(
data = pa_counties_proj,
fill = NA, color = "black", size = 0.3
) +
geom_sf(
data = hospitals_proj,
shape = 21, fill = "black", color = "white", size = 1.2, alpha = 0.7
) +
scale_fill_manual(
name = "Vulnerability Status",
values = c("Not Underserved" = "#4C78A8", "Underserved" = "#D62728"),
na.value = "grey90"
) +
labs(
title = "Underserved Vulnerable Census Tracts in Pennsylvania",
subtitle = "Vulnerable tracts are those with low income and high elderly populations",
caption = "Sources: ACS 2022 (tidycensus), lecture hospital data, county boundaries"
) +
theme_void() +
theme(
legend.position = "right",
legend.title = element_text(size = 10, face = "bold"),
legend.text  = element_text(size = 9),
plot.title   = element_text(size = 14, face = "bold"),
plot.subtitle= element_text(size = 11),
plot.caption = element_text(size = 8, color = "grey30"),
panel.background = element_rect(fill = "grey98", color = NA)
)
vuln <- tract_centroids %>%
st_drop_geometry() %>%
filter(vulnerable == 1)
ggplot(vuln, aes(x = nearest_hosp_dist_mi)) +
geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "#4C78A8", color = "white", alpha = 0.9) +
geom_density(linewidth = 1) +
labs(
title = "Distance to Nearest Hospital (Vulnerable Tracts)",
x = "Distance (miles)",
y = "Density",
caption = "Most vulnerable tracts are located within 5 miles of the nearest hospital, though a small number of rural tracts face much longer travel distances (up to ~18 miles)."
) +
theme_minimal(base_size = 11)
